import{bt as e,d as o,t,b as n,m as l,a6 as a,l as s,z as u,v as r,o as d,R as c,a5 as i,J as p,bu as m,aj as f,c as v,H as y,a2 as b,I as g,bv as C,a1 as h,bw as x,a3 as S,B as E,be as M,r as w,bx as B,by as k,a7 as L,a0 as I}from"./index.ZLNrSxa7.js";import{P as O}from"./vnode.BzFWtM5t.js";import{U as j}from"./index.C7eagngv.js";import{t as z}from"./error.CmW-dgG_.js";import{a as D}from"./scroll.CuImcdyA.js";import{d as A}from"./use-form-common-props.C1EZqqFQ.js";import{i as F}from"./el-popper.B221JJYw.js";const Y=o=>{if(!o)return{onClick:e,onMousedown:e,onMouseup:e};let t=!1,n=!1;return{onClick:e=>{t&&n&&o(e),t=n=!1},onMousedown:e=>{t=e.target===e.currentTarget},onMouseup:e=>{n=e.target===e.currentTarget}}},T=t({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:u([String,Array,Object])},zIndex:{type:u([String,Number])}});const P=o({name:"ElOverlay",props:T,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:t}){const u=n("overlay"),{onClick:r,onMousedown:d,onMouseup:c}=Y(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?l("div",{class:[u.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:r,onMousedown:d,onMouseup:c},[s(o,"default")],O.STYLE|O.CLASS|O.PROPS,["onClick","onMouseup","onMousedown"]):a("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[s(o,"default")])}}),X=t({center:Boolean,alignCenter:Boolean,closeIcon:{type:r},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),$={close:()=>!0},N=(e,o,t,n)=>{let l={offsetX:0,offsetY:0};const a=o=>{const t=o.clientX,a=o.clientY,{offsetX:s,offsetY:u}=l,r=e.value.getBoundingClientRect(),d=r.left,c=r.top,i=r.width,m=r.height,f=document.documentElement.clientWidth,v=document.documentElement.clientHeight,y=-d+s,b=-c+u,g=f-d-i+s,C=v-c-m+u,h=o=>{let r=s+o.clientX-t,d=u+o.clientY-a;(null==n?void 0:n.value)||(r=Math.min(Math.max(r,y),g),d=Math.min(Math.max(d,b),C)),l={offsetX:r,offsetY:d},e.value&&(e.value.style.transform=`translate(${p(r)}, ${p(d)})`)},x=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",x)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",x)},s=()=>{o.value&&e.value&&o.value.removeEventListener("mousedown",a)};return d((()=>{c((()=>{t.value?o.value&&e.value&&o.value.addEventListener("mousedown",a):s()}))})),i((()=>{s()})),{resetPosition:()=>{l={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")}}},R=t({...X,appendToBody:Boolean,appendTo:{type:u([String,Object]),default:"body"},beforeClose:{type:u(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),H={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[j]:e=>m(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},V=(e,o={})=>{f(e)||z("[useLockscreen]","You need to pass a ref param to this function");const t=o.ns||n("popup"),l=v((()=>t.bm("parent","hidden")));if(!y||b(document.body,l.value))return;let a=0,s=!1,u="0";const r=()=>{setTimeout((()=>{"undefined"!=typeof document&&s&&document&&(document.body.style.width=u,S(document.body,l.value))}),200)};g(e,(e=>{if(!e)return void r();s=!b(document.body,l.value),s&&(u=document.body.style.width,h(document.body,l.value)),a=D(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,n=x(document.body,"overflowY");a>0&&(o||"scroll"===n)&&s&&(document.body.style.width=`calc(100% - ${a}px)`)})),C((()=>r()))},U=(e,o)=>{var t;const n=E().emit,{nextZIndex:l}=M();let a="";const s=A(),u=A(),r=w(!1),c=w(!1),i=w(!1),m=w(null!=(t=e.zIndex)?t:l());let f,b;const C=B("namespace",k),h=v((()=>{const o={},t=`--${C.value}-dialog`;return e.fullscreen||(e.top&&(o[`${t}-margin-top`]=e.top),e.width&&(o[`${t}-width`]=p(e.width))),o})),x=v((()=>e.alignCenter?{display:"flex"}:{}));function S(){null==b||b(),null==f||f(),e.openDelay&&e.openDelay>0?({stop:f}=L((()=>D()),e.openDelay)):D()}function O(){null==f||f(),null==b||b(),e.closeDelay&&e.closeDelay>0?({stop:b}=L((()=>Y()),e.closeDelay)):Y()}function z(){e.beforeClose?e.beforeClose((function(e){e||(c.value=!0,r.value=!1)})):O()}function D(){y&&(r.value=!0)}function Y(){r.value=!1}return e.lockScroll&&V(r),g((()=>e.modelValue),(t=>{t?(c.value=!1,S(),i.value=!0,m.value=F(e.zIndex)?l():m.value++,I((()=>{n("open"),o.value&&(o.value.parentElement.scrollTop=0,o.value.parentElement.scrollLeft=0,o.value.scrollTop=0)}))):r.value&&O()})),g((()=>e.fullscreen),(e=>{o.value&&(e?(a=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=a)})),d((()=>{e.modelValue&&(r.value=!0,i.value=!0,S())})),{afterEnter:function(){n("opened")},afterLeave:function(){n("closed"),n(j,!1),e.destroyOnClose&&(i.value=!1)},beforeLeave:function(){n("close")},handleClose:z,onModalClick:function(){e.closeOnClickModal&&z()},close:O,doClose:Y,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&z()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:s,bodyId:u,closed:c,style:h,overlayDialogStyle:x,rendered:i,visible:r,zIndex:m}};export{P as E,R as a,N as b,V as c,H as d,Y as e,$ as f,X as g,U as u};
