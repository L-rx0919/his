import{d as e,b8 as l,ai as t,r as a,I as i,ap as s,g as u,f as n,m as r,k as o,i as d,aj as p,w as m,$ as c,F as f,C as y,E as v,aC as g,b9 as _,e as h,h as b,j,o as x,P as w}from"./index.ZLNrSxa7.js";import{a as V,E as k}from"./el-form-item.CSlDAgNu.js";import{E as C,a as F}from"./el-progress.sc0TlCuW.js";import{E as S}from"./el-button.DSrO3PCY.js";import{F as z}from"./index.DeD-8QMH.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as U,a as E}from"./el-image-viewer.D3svABDR.js";import{E as O}from"./el-link.DKQSWj_6.js";import"./use-form-common-props.C1EZqqFQ.js";import"./castArray.BeWz_jd2.js";import"./error.CmW-dgG_.js";import"./_Uint8Array.DXkM4Snb.js";import"./isEqual.DHfRWznk.js";import"./index.D_Z5gYVY.js";import"./index.CAmgOVMc.js";import"./scroll.CuImcdyA.js";import"./position.BOqJ06QS.js";import"./index.BnUUwnwX.js";const I={class:"el-upload-list__item-info"},q=["onClick"],N={class:"el-upload-list__item-file-name"},W=["onClick"],L=M(e({__name:"FileUpload",props:l({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"*"},uploadBtnText:{type:String,default:"上传文件"},style:{type:Object,default:()=>({width:"300px"})}},{modelValue:{type:[Array],required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=e,_=t(e,"modelValue"),h=a([]),b=a(!1),j=a(0);function x(e){return!(e.size>1024*l.maxFileSize*1024)||(g.warning("上传图片不能大于"+l.maxFileSize+"M"),!1)}function w(e){return new Promise(((t,a)=>{const i=e.file,s=new FormData;s.append(l.name,i),Object.keys(l.data).forEach((e=>{s.append(e,l.data[e])})),z.upload(s).then((e=>{t(e)})).catch((e=>{a(e)}))}))}i(_,(e=>{h.value=e.map((e=>({name:e.substring(e.lastIndexOf("/")+1),url:e})))}),{immediate:!0});const V=e=>{j.value=e.percent},k=e=>{g.success("上传成功"),_.value=[..._.value,e.url]},M=e=>{g.error("上传失败")};return(e,t)=>{const a=S,i=s("Document"),g=v,U=s("Close"),E=C,O=F;return n(),u("div",null,[r(E,{"file-list":d(h),"onUpdate:fileList":t[0]||(t[0]=e=>p(h)?h.value=e:null),style:o(l.style),"before-upload":x,"http-request":w,"on-progress":V,"on-success":k,"on-error":M,accept:l.accept,limit:l.limit,multiple:""},{file:m((({file:e})=>[y("div",I,[y("a",{class:"el-upload-list__item-name",onClick:l=>function(e){const{url:l,name:t}=e;l&&z.download(l,t)}(e)},[r(g,null,{default:m((()=>[r(i)])),_:1}),y("span",N,f(e.name),1),y("span",{class:"el-icon--close",onClick:l=>{return t=e.url,void z.delete(t).then((()=>{_.value=_.value.filter((e=>e!==t))}));var t}},[r(g,null,{default:m((()=>[r(U)])),_:1})],8,W)],8,q)])])),default:m((()=>[r(a,{type:"primary",disabled:d(h).length>=l.limit},{default:m((()=>[c(f(l.uploadBtnText),1)])),_:1},8,["disabled"])])),_:1},8,["file-list","style","accept","limit"]),r(O,{style:o({display:d(b)?"inline-flex":"none",width:"100%"}),percentage:d(j)},null,8,["style","percentage"])])}}}),[["__scopeId","data-v-4fb49ff2"]]),P=M(e({__name:"SingleImageUpload",props:l({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"},style:{type:Object,default:()=>({width:"150px",height:"150px"})}},{modelValue:{type:String,required:!0,default:()=>""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){_((e=>({"794add14":l.style.width,d37c68ce:l.style.height})));const l=e,a=t(e,"modelValue");function i(e){return l.accept.split(",").map((e=>e.trim())).some((l=>"image/*"===l?e.type.startsWith("image/"):l.startsWith(".")?e.name.toLowerCase().endsWith(l):e.type===l))?!(e.size>1024*l.maxFileSize*1024)||(g.warning("上传图片不能大于"+l.maxFileSize+"M"),!1):(g.warning(`上传文件的格式不正确，仅支持：${l.accept}`),!1)}function u(e){return new Promise(((t,a)=>{const i=e.file,s=new FormData;s.append(l.name,i),Object.keys(l.data).forEach((e=>{s.append(e,l.data[e])})),z.upload(s).then((e=>{t(e)})).catch((e=>{a(e)}))}))}function o(){a.value=""}const d=e=>{g.success("上传成功"),a.value=e.url},p=e=>{g.error("上传失败: "+e.message)};return(e,t)=>{const c=U,f=s("CircleCloseFilled"),y=v,g=s("Plus"),_=C;return n(),h(_,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:"single-upload","list-type":"picture-card","show-file-list":!1,accept:l.accept,"before-upload":i,"http-request":u,"on-success":d,"on-error":p,multiple:""},{default:m((()=>[a.value?(n(),h(c,{key:0,src:a.value},null,8,["src"])):b("",!0),a.value?(n(),h(y,{key:1,class:"single-upload__delete-btn",onClick:j(o,["stop"])},{default:m((()=>[r(f)])),_:1})):(n(),h(y,{key:2,class:"single-upload__add-btn"},{default:m((()=>[r(g)])),_:1}))])),_:1},8,["modelValue","accept"])}}}),[["__scopeId","data-v-5de855dc"]]),D={style:{width:"100%"}},A=["src"],H={class:"el-upload-list__item-actions"},K=["onClick"],Q=["onClick"],Z=e({__name:"MultiImageUpload",props:l({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"}},{modelValue:{type:[Array],required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=e,i=a(!1),o=a(0),c=t(e,"modelValue"),f=a([]);function _(e){return l.accept.split(",").map((e=>e.trim())).some((l=>"image/*"===l?e.type.startsWith("image/"):l.startsWith(".")?e.name.toLowerCase().endsWith(l):e.type===l))?!(e.size>1024*l.maxFileSize*1024)||(g.warning("上传图片不能大于"+l.maxFileSize+"M"),!1):(g.warning(`上传文件的格式不正确，仅支持：${l.accept}`),!1)}function j(e){return new Promise(((t,a)=>{const i=e.file,s=new FormData;s.append(l.name,i),Object.keys(l.data).forEach((e=>{s.append(e,l.data[e])})),z.upload(s).then((e=>{t(e)})).catch((e=>{a(e)}))}))}function V(){g.warning("最多只能上传"+l.limit+"张图片")}const k=(e,l)=>{g.success("上传成功");const t=f.value.findIndex((e=>e.uid===l.uid));-1!==t&&(f.value[t].url=e.url,f.value[t].status="success",c.value[t]=e.url)},F=e=>{g.error("上传失败: "+e.message)},S=()=>{i.value=!1};return x((()=>{f.value=c.value.map((e=>({url:e})))})),(e,t)=>{const a=s("Plus"),g=v,x=s("zoom-in"),M=s("Delete"),U=C,O=E;return n(),u(w,null,[r(U,{"file-list":d(f),"onUpdate:fileList":t[0]||(t[0]=e=>p(f)?f.value=e:null),"list-type":"picture-card","before-upload":_,"http-request":j,"on-success":k,"on-error":F,"on-exceed":V,accept:l.accept,limit:l.limit,multiple:""},{file:m((({file:e})=>[y("div",D,[y("img",{class:"el-upload-list__item-thumbnail",src:e.url},null,8,A),y("span",H,[y("span",{onClick:l=>{return t=e.url,o.value=c.value.findIndex((e=>e===t)),void(i.value=!0);var t}},[r(g,null,{default:m((()=>[r(x)])),_:1})],8,K),y("span",{onClick:l=>{return t=e.url,void z.delete(t).then((()=>{const e=c.value.indexOf(t);-1!==e&&(c.value.splice(e,1),f.value.splice(e,1))}));var t}},[r(g,null,{default:m((()=>[r(M)])),_:1})],8,Q)])])])),default:m((()=>[r(g,null,{default:m((()=>[r(a)])),_:1})])),_:1},8,["file-list","accept","limit"]),d(i)?(n(),h(O,{key:0,"zoom-rate":1.2,"initial-index":d(o),"url-list":c.value,onClose:S},null,8,["initial-index","url-list"])):b("",!0)],64)}}}),$={class:"app-container"},B=e({__name:"upload",setup(e){const l=a("https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"),t=a(["https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"]),i=a(["https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg","https://s2.loli.net/2023/05/24/RuHFMwW4rG5lIqs.jpg"]);return(e,a)=>{const s=O,o=P,f=V,y=L,v=k;return n(),u("div",$,[r(s,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/upload.vue",type:"primary",target:"_blank",class:"mb-10"},{default:m((()=>a[3]||(a[3]=[c(" 示例源码 请点击>>>> ")]))),_:1}),r(v,null,{default:m((()=>[r(f,{label:"单图上传"},{default:m((()=>[r(o,{modelValue:d(l),"onUpdate:modelValue":a[0]||(a[0]=e=>p(l)?l.value=e:null)},null,8,["modelValue"])])),_:1}),r(f,{label:"多图上传"},{default:m((()=>[r(Z,{modelValue:d(t),"onUpdate:modelValue":a[1]||(a[1]=e=>p(t)?t.value=e:null)},null,8,["modelValue"])])),_:1}),r(f,{label:"文件上传"},{default:m((()=>[r(y,{modelValue:d(i),"onUpdate:modelValue":a[2]||(a[2]=e=>p(i)?i.value=e:null)},null,8,["modelValue"])])),_:1})])),_:1})])}}});export{B as default};
